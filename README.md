# Simplex

Python implementation of the Simplex algorithm, done for the OA course supervised by Nicolas Bousquet at ENS de Lyon.

## Installation

Dependencies:
- [SortedContainers](http://www.grantjenks.com/docs/sortedcontainers/)

```
pip install sortedcontainers
```

## Usage

```
simplex.py [-h] [-v] [-p {bland,random,largest,smallest,maximum}] file

positional arguments:
  file                  the input LP problem

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         enable verbose output
  -p {bland,random,largest,smallest,maximum}, --pivot {bland,random,largest,smallest,maximum}
                        select the pivot rule to be used during resolution
                        (default: bland)
```

Running `python3 simplex.py --help` will output similar instructions.

The `file` argument must contain some LP problem represented as:

```
n
m
c1 c2 ... cn
b1 b2 ... bm
a11 a12 ... a1n
a21 a22 ... a2n
...
am1 am2 ... amn
```

where the goal is to maximize `c.x` under constraints `Ax <= b`, `x >= 0`.

## Assignment Notes

### Pivot Rules
5 different pivot rules were implemented:
- **Bland's rule**. See [here](https://en.wikipedia.org/wiki/Bland's_rule) for an explanation.
- **Largest Coefficient rule**. At each step, we choose the entering variable with the *largest* coefficient in the objective function.
- **Smallest Coefficient rule**. At each step, we choose the entering variable with the *smallest* coefficient in the objective function.
- **Random rule**. We pick entering and leaving variables uniformly at random among valid candidates.
- **Maximum Increase rule**. We pick entering and leaving variables such that the increase is maximized in the objective function.

### Test Examples

#### From exercise sheets

Three problems have been taken from exercise sheets and formatted as valid input files for our solver.
- `tests/lumberjack`.

- `tests/busdrivers`.  
  The **Bus drivers** problem consists in finding the *minimum amount* of bus drivers to hire when each driver works for 5 consecutive days and you need 17 drivers working on Mondays, 21 on Tuesdays, 15 on Wednesdays, 20 on Thursdays, 23 on Fridays, 15 on Saturdays and 9 on Sundays.
  We can express this as a LP problem by defining variables `x_i`: *number of drivers hired to start working on the ith day of the week*.
  Then for each day `i`, we need the sufficient amount of drivers still working that day.
  We end up with the following constraints:

  - `x_1 + x_4 + x_5 + x_6 + x_7 >= 17`
  - `x_1 + x_2 + x_5 + x_6 + x_7 >= 21`
  - `x_1 + x_2 + x_3 + x_6 + x_7 >= 15`
  - `x_1 + x_2 + x_3 + x_4 + x_7 >= 20`
  - `x_1 + x_2 + x_3 + x_4 + x_5 >= 23`
  - `x_2 + x_3 + x_4 + x_5 + x_6 >= 15`
  - `x_3 + x_4 + x_5 + x_6 + x_7 >= 9`

  With the aim of minimizing `x_1 + ... + x_n`.  
  Once expressed as a maximization problem in the defined format, running our solver gives us an optimal minimum value of `73/3` drivers to hire.

- `tests/fraction`.

#### Randomly generated

The file `generate.py` was made to generate random LP problems. Run it as follow:

```
python3 generate.py n m {bounded,unbounded,infeasible} > destination
```

Some examples have been included in the `tests/` directory, with the type of problem generated and the size in the title.
Notably, running each problem 

#### Other examples

Some noteworthy examples have also been included in the `tests/` directory.

- `tests/example1`.  
  This simple example illustrates how cycling can happen when using the *Largest Coefficient Rule* pivot.
  While this LP instance is solved in only `7` pivot operations using *Bland's rule*, it simply never ends when using the former. We essentially cycle through the same basis, without improving our solution.

- `tests/example2`.  
  This example was generated by running `python3 worst_bland.py 20`, and is a construction of the [Klee-Minty cube](http://users.uom.gr/~samaras/pdf/BC6.pdf).
  In this paper, it is showed that Bland's rule performs exponentially on this problem. In our example, it needs `21891` pivot operations to find the optimal solution, whereas the *Largest Coefficient rule* ends in only one step.
  However, the same paper shows that with a slightly modified configuration, we can construct a configuration in which this other rule performs exponentially too. Hence,

- `tests/example3`.  
  This example was generated by running `python3 worst_max.py 10`. It is the configuration mentionned earlier, which exhibits an exponential behavior from the *Largest Coefficient rule*. With `d` the number of variables in our configuration, this rule needs exactly `2^n - 1` pivot operations to find the optimal soluton. In our example, the *Maximum Coefficient rule* leads to `1023` pivot operations, vastly outperformed by *Bland's rule*, requiring only `177` pivot operations.

  *NB*: Last two examples are solved with only one pivot operation with the *Maximum Increase rule*.
